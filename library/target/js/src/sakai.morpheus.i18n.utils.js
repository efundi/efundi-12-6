(function(a){portal.i18n=portal.i18n||{};portal.i18n.translations=portal.i18n.translations||{};portal.i18n.loadProperties=function(b){if(!b.resourceClass||!b.resourceBundle||!b.namespace){console.log("You must supply a resourceClass, a resourceBundle and a namespace. Doing nothing ...");return}if(b.debug){console.log("resourceClass: "+b.resourceClass);console.log("resourceBundle: "+b.resourceBundle);console.log("namespace: "+b.namespace)}portal.i18n.translations[b.namespace]=portal.i18n.translations[b.namespace]||{};$PBJQ.ajax({url:"/sakai-ws/rest/i18n/getI18nProperties",cache:true,dataType:"text",data:{locale:portal.locale,resourceclass:b.resourceClass,resourcebundle:b.resourceBundle},}).done(function(d,e,c){d.split("\n").forEach(function(g){var f=g.split("=");if(f.length==2){portal.i18n.translations[b.namespace][f[0]]=f[1]}if(b.debug){console.log("Updated translations: ");console.log(portal.i18n.translations[b.namespace])}});if(b.callback){b.callback()}}).fail(function(c,e,d){console.log(d)})};portal.i18n.tr=function(e,d,c){if(!e||!d){console.log("You must supply a namespace and a key.");return}var b=portal.i18n.translations[e][d];if(!b){console.log(e+"#key "+d+" not found. Returning key ...");return d}if(c!=undefined){for(var f in c){b=b.replace("{"+f+"}",c[f])}}return b};Handlebars.registerHelper("tr",function(d,c,b){return new Handlebars.SafeString(portal.i18n.tr(d,c,b.hash))})})($PBJQ);