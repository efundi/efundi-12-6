$PBJQ(document).ready(function(){if($PBJQ("#reorder-list li").size()-1>15){$PBJQ(".grabHandle").show();$PBJQ("#inputFieldMessage").show();$PBJQ("#inputKbdMessage").remove()}$PBJQ("#reorder-list li").each(function(a){$PBJQ("#lastMoveArrayInit").append($PBJQ(this).attr("id")+" ");$PBJQ("#lastMoveArray").append($PBJQ(this).attr("id")+" ")});$PBJQ('input[id^="index"]').click(function(a){a.stopPropagation()});$PBJQ('input[id^="index"]').bind("keypress",function(b){var a=b.charCode||b.keyCode;return(a==13)?false:true});$PBJQ("#undo-all").click(function(a){var b;b=$PBJQ.trim($PBJQ("#lastMoveArrayInit").text()).split(" ");for(z in b){thisRow=document.getElementById(b[z]);$PBJQ(thisRow).appendTo("#reorder-list")}a.preventDefault();registerChange();$PBJQ("#undo-all").hide();$PBJQ("#undo-all-inact").show();$PBJQ("#undo-last-inact").show();$PBJQ("#undo-last").hide()});$PBJQ("#undo-last").click(function(d){var c;var a;var b;c=$PBJQ.trim($PBJQ("#lastMoveArray").text()).split(" ");for(z in c){thisRow=document.getElementById(c[z]);$PBJQ(thisRow).appendTo("#reorder-list")}a=$PBJQ.trim($PBJQ("#lastItemMoved").text());b=$PBJQ("li:eq("+a.substr(20)+")");$PBJQ(b).addClass("recentMove");d.preventDefault();registerChange("notfluid",b);$PBJQ("#undo-last-inact").fadeIn("slow");$PBJQ("#undo-last").hide()});$PBJQ('input[id^="index"]').change(function(){var f=this;preserveStatus();var d=parseInt($PBJQ(this).siblings('input[id^="holder"]').attr("value"));var e=parseInt(this.value);if(isNaN(e)||e>$PBJQ('input[id^="index"]').size()){var b=$PBJQ("#failedValidMessage").text();$PBJQ("#messageHolder").text(b.replace("#",$PBJQ('input[id^="index"]').size()));$PBJQ(".orderable-selected").removeClass("orderable-selected");$PBJQ("#messageHolder").removeClass("messageSuccess");$PBJQ("#messageHolder").addClass("messageValidation");var a=$PBJQ(f).position();$PBJQ("#messageHolder").css({position:"absolute",height:"1.3em",top:a.top,left:55});$PBJQ("#messageHolder").fadeIn("slow");$PBJQ("#messageHolder").animate({opacity:1},2000,function(){$PBJQ(f).val(d);f.focus();f.select()});$PBJQ("#messageHolder").fadeOut("slow");$PBJQ(this).parents("li").addClass("orderable-selected");return(null)}var c=$PBJQ('input[id^="index"]');$PBJQ("#undo-last").fadeIn("slow");$PBJQ("#undo-last-inact").hide();$PBJQ("#undo-all").fadeIn("slow");$PBJQ("#undo-all-inact").hide();if(e==="1"){$PBJQ($PBJQ(this).parents("li")).insertBefore($PBJQ(this).parents("li").siblings("li").children("span").children("input[value="+e+"]").parents("li"))}else{if(e==c.length){$PBJQ($PBJQ(this).parents("li")).insertAfter($PBJQ(this).parents("li").siblings("li").children("span").children("input[value="+e+"]").parents("li"))}else{if(e>d){$PBJQ($PBJQ(this).parents("li")).insertAfter($PBJQ(this).parents("li").siblings("li").children("span").children("input[value="+e+"]").parents("li"))}else{$PBJQ($PBJQ(this).parents("li")).insertBefore($PBJQ(this).parents("li").siblings("li").children("span").children("input[value="+e+"]").parents("li"))}}}registerChange("notfluid",$PBJQ(this).parents("li"))});return $PBJQ("#reorder-list").keyboardSortable({items:"li:not(.notsortable)",start:function(a,b){preserveStatus(b)},update:function(a,b){registerChange(a,b)},})});var registerChange=function(b,d){var k=$PBJQ("#reorder-list li").size();if(b!=="notfluid"){d=$PBJQ("li[aria-selected='true']")}$PBJQ("#lastItemMoved").text($PBJQ(d).attr("id"));$PBJQ(d).addClass("recentMove");var a=0;a=$PBJQ((d).prevAll("li").length+1);var f=$PBJQ('input[id^="index"]');var h=$PBJQ('input[id^="holder"]');var j=$PBJQ("select.selectSet");for(var c=0;c<f.length;c=c+1){$PBJQ(f[c]).attr("value",c+1).val(c+1)}for(var g=0;g<h.length;g=g+1){$PBJQ(h[g]).attr("value",g+1).val(g+1)}for(var e=0;e<j.length;e=e+1){$PBJQ(j[e]).val(e+1);$PBJQ(j[e]).find("option").removeAttr("selected");$PBJQ(j[e]).find("option[value="+(e+1)+"]").attr("selected","selected")}$PBJQ("#undo-last").fadeIn("slow");$PBJQ("#undo-last-inact").hide();$PBJQ("#undo-all").fadeIn("slow");$PBJQ("#undo-all-inact").hide();$PBJQ(d).animate({opacity:1},2000,function(){$PBJQ(d).removeClass("recentMove")})};var preserveStatus=function(a){$PBJQ("#lastMoveArray").text("");$PBJQ("#reorder-list li").each(function(b){if($PBJQ(this).attr("id")!==undefined&&$PBJQ(this).attr("id")!=="undefined_avatar"){$PBJQ("#lastMoveArray").append($PBJQ(this).attr("id")+" ")}})};